// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: dependencies.sql

package db

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const createDependency = `-- name: CreateDependency :exec
INSERT INTO dependencies (version_id, name, constraint_expr)
VALUES ($1, $2, $3)
`

type CreateDependencyParams struct {
	VersionID      pgtype.UUID
	Name           pgtype.Text
	ConstraintExpr pgtype.Text
}

func (q *Queries) CreateDependency(ctx context.Context, arg CreateDependencyParams) error {
	_, err := q.db.Exec(ctx, createDependency, arg.VersionID, arg.Name, arg.ConstraintExpr)
	return err
}

const deleteDependenciesByVersionID = `-- name: DeleteDependenciesByVersionID :exec
DELETE
FROM dependencies
WHERE version_id = $1
`

func (q *Queries) DeleteDependenciesByVersionID(ctx context.Context, versionID pgtype.UUID) error {
	_, err := q.db.Exec(ctx, deleteDependenciesByVersionID, versionID)
	return err
}

const getDependenciesByVersionID = `-- name: GetDependenciesByVersionID :many
SELECT dependency.name            AS dependency_name,
       dependency.constraint_expr AS constraint_expr
FROM dependencies dependency
WHERE version_id = $1
`

type GetDependenciesByVersionIDRow struct {
	DependencyName pgtype.Text
	ConstraintExpr pgtype.Text
}

func (q *Queries) GetDependenciesByVersionID(ctx context.Context, versionID pgtype.UUID) ([]GetDependenciesByVersionIDRow, error) {
	rows, err := q.db.Query(ctx, getDependenciesByVersionID, versionID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetDependenciesByVersionIDRow
	for rows.Next() {
		var i GetDependenciesByVersionIDRow
		if err := rows.Scan(&i.DependencyName, &i.ConstraintExpr); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}
